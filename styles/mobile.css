/**
 * ============================================================================
 * VECTHARE MOBILE STYLES
 * ============================================================================
 * Full-screen mobile modal handling following CarrotKernel's approach
 * Using aggressive !important overrides with 100vw/100vh
 *
 * @author Coneja Chibi
 * @version 2.2.0-alpha
 * ============================================================================
 */

/* ============================================================================
 * MOBILE: Full screen modals (following CarrotKernel pattern)
 * ============================================================================ */

/* Mobile first - all modals go full screen */
@media (max-width: 768px) {
    /* BASE MODAL OVERLAY */
    .vecthare-modal {
        padding: 0 !important;
        margin: 0 !important;
    }

    /* BASE MODAL CONTENT - NUCLEAR OPTION */
    .vecthare-modal-content,
    div.vecthare-modal-content,
    .vecthare-modal .vecthare-modal-content {
        position: fixed !important;
        top: 0 !important;
        left: 0 !important;
        right: 0 !important;
        bottom: 0 !important;
        width: 100vw !important;
        max-width: 100vw !important;
        height: 100vh !important;
        max-height: 100vh !important;
        min-width: 100vw !important;
        min-height: 100vh !important;
        margin: 0 !important;
        border-radius: 0 !important;
        border: none !important;
        transform: none !important;
        animation: none !important;
    }

    /* DATABASE BROWSER - NUCLEAR FULL SCREEN */
    .vecthare-database-browser-content,
    div.vecthare-database-browser-content,
    .vecthare-modal .vecthare-database-browser-content,
    .vecthare-modal-content.vecthare-database-browser-content,
    .vecthare-database-browser-content.popup,
    .vecthare-modal-content.vecthare-database-browser-content.popup,
    #vecthare_database_browser_modal .vecthare-database-browser-content {
        position: fixed !important;
        top: 0 !important;
        left: 0 !important;
        right: 0 !important;
        bottom: 0 !important;
        width: 100vw !important;
        max-width: 100vw !important;
        height: 100vh !important;
        max-height: 100vh !important;
        min-width: 100vw !important;
        min-height: 100vh !important;
        margin: 0 !important;
        border-radius: 0 !important;
        border: none !important;
        transform: none !important;
        display: flex !important;
        flex-direction: column !important;
        overflow: hidden !important;
    }

    /* CONTENT VECTORIZER - NUCLEAR FULL SCREEN */
    .vecthare-content-vectorizer,
    div.vecthare-content-vectorizer,
    .vecthare-modal .vecthare-content-vectorizer,
    .vecthare-modal-content.vecthare-content-vectorizer {
        position: fixed !important;
        top: 0 !important;
        left: 0 !important;
        right: 0 !important;
        bottom: 0 !important;
        width: 100vw !important;
        max-width: 100vw !important;
        height: 100vh !important;
        max-height: 100vh !important;
        min-width: 100vw !important;
        min-height: 100vh !important;
        margin: 0 !important;
        border-radius: 0 !important;
        border: none !important;
        transform: none !important;
        display: flex !important;
        flex-direction: column !important;
    }

    /* CHUNK VISUALIZER - NUCLEAR FULL SCREEN */
    .vecthare-visualizer-container,
    div.vecthare-visualizer-container,
    #vecthare_visualizer_modal .vecthare-visualizer-container {
        position: fixed !important;
        top: 0 !important;
        left: 0 !important;
        right: 0 !important;
        bottom: 0 !important;
        width: 100vw !important;
        max-width: 100vw !important;
        height: 100vh !important;
        max-height: 100vh !important;
        min-width: 100vw !important;
        min-height: 100vh !important;
        margin: 0 !important;
        border-radius: 0 !important;
        border: none !important;
        transform: none !important;
        display: flex !important;
        flex-direction: column !important;
    }

    /* DIAGNOSTICS - NUCLEAR FULL SCREEN */
    .vecthare-diagnostics-content,
    div.vecthare-diagnostics-content,
    .vecthare-modal .vecthare-diagnostics-content {
        position: fixed !important;
        top: 0 !important;
        left: 0 !important;
        right: 0 !important;
        bottom: 0 !important;
        width: 100vw !important;
        max-width: 100vw !important;
        height: 100vh !important;
        max-height: 100vh !important;
        min-width: 100vw !important;
        min-height: 100vh !important;
        margin: 0 !important;
        border-radius: 0 !important;
        border: none !important;
        transform: none !important;
    }

    /* ACTIVATION EDITOR - NUCLEAR FULL SCREEN */
    .vecthare-activation-editor,
    div.vecthare-activation-editor,
    .vecthare-modal .vecthare-activation-editor {
        position: fixed !important;
        top: 0 !important;
        left: 0 !important;
        right: 0 !important;
        bottom: 0 !important;
        width: 100vw !important;
        max-width: 100vw !important;
        height: 100vh !important;
        max-height: 100vh !important;
        min-width: 100vw !important;
        min-height: 100vh !important;
        margin: 0 !important;
        border-radius: 0 !important;
        border: none !important;
        transform: none !important;
    }

    /* MODEL SWITCHER - NUCLEAR FULL SCREEN */
    .vecthare-model-switcher-content,
    div.vecthare-model-switcher-content {
        position: fixed !important;
        top: 0 !important;
        left: 0 !important;
        right: 0 !important;
        bottom: 0 !important;
        width: 100vw !important;
        max-width: 100vw !important;
        height: 100vh !important;
        max-height: 100vh !important;
        margin: 0 !important;
        border-radius: 0 !important;
        border: none !important;
        transform: none !important;
    }

    /* RENAME DIALOG - NUCLEAR FULL SCREEN */
    .vecthare-rename-dialog,
    div.vecthare-rename-dialog {
        position: fixed !important;
        top: 0 !important;
        left: 0 !important;
        right: 0 !important;
        bottom: 0 !important;
        width: 100vw !important;
        max-width: 100vw !important;
        height: 100vh !important;
        max-height: 100vh !important;
        margin: 0 !important;
        border-radius: 0 !important;
        border: none !important;
        transform: none !important;
    }

    /* ========================================================================
     * MODAL HEADER - Always visible and touchable
     * ======================================================================== */

    .vecthare-modal-header,
    .vecthare-visualizer-header,
    .vecthare-cv-header {
        position: sticky !important;
        top: 0 !important;
        z-index: 100 !important;
        padding: 12px 16px !important;
        border-radius: 0 !important;
        flex-shrink: 0 !important;
    }

    .vecthare-modal-header h3,
    .vecthare-visualizer-title {
        font-size: 0.66em !important;
        max-width: 60%;
    }

    /* Close buttons - LARGE touch targets */
    .vecthare-modal-close,
    .vecthare-visualizer-close,
    #vecthare_visualizer_close {
        width: 48px !important;
        height: 48px !important;
        min-width: 48px !important;
        min-height: 48px !important;
        font-size: 1.5em !important;
        display: flex !important;
        align-items: center !important;
        justify-content: center !important;
        touch-action: manipulation !important;
    }

    /* ========================================================================
     * MODAL BODY - Scrollable content area
     * ======================================================================== */

    .vecthare-modal-body,
    .vecthare-cv-body {
        flex: 1 !important;
        overflow-y: auto !important;
        -webkit-overflow-scrolling: touch !important;
        padding: 12px !important;
        min-height: 0 !important;
    }

    /* ========================================================================
     * DATABASE BROWSER INTERNALS
     * ======================================================================== */

    .vecthare-browser-tabs {
        padding: 8px 12px 0 12px !important;
        overflow-x: auto !important;
        flex-shrink: 0 !important;
    }

    .vecthare-tab-btn::before {
        display: none !important;
    }

    .vecthare-tab-btn {
        padding: 10px 14px !important;
        min-height: 44px !important;
        font-size: 0.85em !important;
        white-space: nowrap !important;
    }

    .vecthare-browser-content {
        flex: 1 !important;
        overflow: hidden !important;
        display: flex !important;
        flex-direction: column !important;
        min-height: 0 !important;
    }

    .vecthare-tab-content {
        flex: 1 !important;
        overflow-x: hidden !important;
        overflow-y: scroll !important;
        display: none !important;
        flex-direction: column !important;
        min-height: 0 !important;
    }

    .vecthare-tab-content.active {
        display: flex !important;
    }

    .vecthare-scope-filters {
        /*display: grid !important;
        grid-template-columns: 1fr 1fr !important;*/
        gap: 8px !important;
        padding: 12px !important;
        flex-shrink: 0 !important;
    }

    .vecthare-scope-filter {
        padding: 10px !important;
        min-height: 44px !important;
        font-size: 0.85em !important;
    }

    .vecthare-type-filters {
        padding: 8px 12px !important;
        flex-shrink: 0 !important;
        overflow-x: scroll !important;
        flex-wrap: nowrap !important;
    }

    .vecthare-type-filters label {
        gap: 4px !important;
    }

    .vecthare-search-results {
        overflow-y: scroll !important;
        min-height: max-content !important;
    }

    .vecthare-search-box {
        padding: 12px !important;
        flex-shrink: 0 !important;
    }

    .vecthare-search-box input {
        min-height: 44px !important;
    }

    .vecthare-search-collection {
        min-height: auto;
        display: flex;
        flex-direction: column;
    }

    .vecthare-collections-list {
        flex: 1 !important;
        overflow-y: auto !important;
        -webkit-overflow-scrolling: touch !important;
        padding: 0 12px 12px 12px !important;
        min-height: 0 !important;
    }

    .vecthare-collection-card {
        padding: 12px !important;
        margin-bottom: 10px !important;
        overflow-x: hidden;
        min-height: max-content;
    }

    .vecthare-collection-header {
        flex-direction: column !important;
        gap: 8px !important;
    }

    .vecthare-collection-actions {
        flex-direction: column !important;
        gap: 8px !important;
    }

    .vecthare-collection-title,
    .vecthare-collection-meta {
        font-size: 0.6em !important;
        gap: 10px !important;
    }

    .vecthare-collection-meta::before {
        display: none !important;
    }

    .vecthare-btn-sm {
        width: 100% !important;
        min-height: 44px !important;
        justify-content: center !important;
    }

    .vecthare-browser-stats {
        padding: 10px 12px !important;
        flex-shrink: 0 !important;
    }

    /* ========================================================================
     * CHUNK VISUALIZER INTERNALS
     * ======================================================================== */

    .vecthare-visualizer-body {
        flex: 1 !important;
        display: flex !important;
        flex-direction: column !important;
        overflow: hidden !important;
        min-height: 0 !important;
    }

    /* Chunk list - collapsible top section */
    .vecthare-chunk-list-panel {
        width: 100% !important;
        max-width: 100% !important;
        min-width: 100% !important;
        max-height: 35vh !important;
        border-right: none !important;
        border-bottom: 1px solid var(--SmartThemeBorderColor) !important;
        flex-shrink: 0 !important;
        overflow: hidden !important;
        display: flex !important;
        flex-direction: column !important;
    }

    .vecthare-list-toolbar {
        padding: 8px !important;
        flex-shrink: 0 !important;
    }

    .vecthare-list-toolbar .vecthare-list-search {
        min-height: 32px !important;
        font-size: 0.88em !important;
        padding: 4px 10px;
    }

    .vecthare-list-controls {
        flex-wrap: wrap !important;
        gap: 6px !important;
    }

    .vecthare-list-controls select {
        min-height: 36px !important;
        font-size: 0.85em !important;
    }

    .vecthare-chunk-list {
        flex-grow: 3 !important;
        flex-basis: 100px !important;
        flex-shrink: 0 !important;
        overflow-y: auto !important;
        -webkit-overflow-scrolling: touch !important;
        padding: 8px !important;
        min-height: 0 !important;
        display: flex;
        flex-direction: column;
    }
    .vecthare-chunk-list .vecthare-load-more {
        padding: 6px;
        font-size: 0.6em;
    }

    .vecthare-chunk-item {
        padding: 10px !important;
        min-height: 44px !important;
    }

    /* Detail panel - takes remaining space */
    .vecthare-chunk-detail-panel {
        flex: 1 !important;
        min-height: 0 !important;
        overflow: hidden !important;
        display: flex !important;
        flex-direction: column !important;
    }

    .vecthare-detail-header {
        padding: 4px 10px !important;
        flex-shrink: 0 !important;
        max-height: 48px;
    }
    .vecthare-detail-header
        .vecthare-detail-name-section
        .vecthare-chunk-name-input {
        padding: 8px 10px;
        font-size: 0.88em;
        max-height: 32px !important;
    }

    .vecthare-detail-content {
        flex: 1 !important;
        overflow-y: auto !important;
        -webkit-overflow-scrolling: touch !important;
        padding: 12px !important;
        min-height: 0 !important;
    }

    .vecthare-bulk-actions {
        padding: 8px 12px !important;
        flex-shrink: 0 !important;
    }

    .vecthare-list-status {
        padding: 6px 12px !important;
        flex-shrink: 0 !important;
    }

    /* Visualizer tabs (for chat collections) */
    .vecthare-visualizer-tabs {
        padding: 0 12px !important;
        flex-shrink: 0 !important;
    }

    .vecthare-visualizer-tab {
        padding: 10px 16px !important;
        min-height: 44px !important;
    }

    .vecthare-visualizer-body.vecthare-scenes-tab {
        display: none !important;
    }
    .vecthare-visualizer-body.vecthare-scenes-tab.active {
        display: block !important;
    }

    .vecthare-visualizer-body.vecthare-groups-tab {
        display: none !important;
    }
    .vecthare-visualizer-body.vecthare-groups-tab.active {
        display: block !important;
    }

    /* ========================================================================
     * CONTENT VECTORIZER INTERNALS
     * ======================================================================== */

    .vecthare-cv-body {
        flex: 1 !important;
        overflow-y: auto !important;
        -webkit-overflow-scrolling: touch !important;
        padding: 12px !important;
        min-height: 0 !important;
    }

    .vecthare-cv-type-dropdown {
        min-height: 44px !important;
    }

    .vecthare-cv-scope-options {
        grid-template-columns: 1fr !important;
    }

    .vecthare-cv-scope-card {
        min-height: 44px !important;
    }

    .vecthare-cv-footer {
        position: sticky !important;
        bottom: 0 !important;
        padding: 12px !important;
        flex-shrink: 0 !important;
        gap: 8px !important;
        flex-wrap: wrap !important;
    }

    .vecthare-cv-footer button {
        flex: 1 1 auto !important;
        min-height: 44px !important;
        min-width: 100px !important;
    }

    /* ========================================================================
     * TOUCH OPTIMIZATIONS
     * ======================================================================== */

    /* All buttons need good touch targets */
    .vecthare-btn,
    .vecthare-btn-primary,
    .vecthare-btn-secondary,
    .vecthare-btn-danger,
    button[class*="vecthare"] {
        min-height: 44px !important;
        touch-action: manipulation !important;
    }

    /* Form inputs */
    input[type="text"],
    input[type="number"],
    input[type="search"],
    select,
    textarea {
        min-height: 44px !important;
    }

    /* Checkboxes and radios */
    input[type="checkbox"],
    input[type="radio"] {
        width: 22px !important;
        height: 22px !important;
    }
}

/* ============================================================================
 * VERY SMALL SCREENS: < 480px
 * ============================================================================ */

@media (max-width: 480px) {
    /* Even more aggressive stacking */
    .vecthare-scope-filters {
        grid-template-columns: 1fr !important;
    }

    .vecthare-cv-footer {
        flex-direction: column !important;
    }

    .vecthare-cv-footer button {
        width: 100% !important;
    }

    /* Smaller chunk list area */
    .vecthare-chunk-list-panel {
        max-height: 40vh !important;
    }

    /* Compact headers */
    .vecthare-modal-header,
    .vecthare-visualizer-header {
        padding: 10px 12px !important;
    }

    .vecthare-visualizer-header .vecthare-visualizer-title:nth-child(1) {
        font-size: 0.66em !important;
        width: 80%;
        word-wrap: break-word;
    }

/* ============================================================================
 * LANDSCAPE MOBILE
 * ============================================================================ */

@media (max-width: 900px) and (orientation: landscape) and (max-height: 500px) {
    /* Side-by-side for visualizer in landscape */
    .vecthare-visualizer-body {
        flex-direction: row !important;
    }

    .vecthare-chunk-list-panel {
        width: 40% !important;
        max-width: 300px !important;
        min-width: 200px !important;
        max-height: none !important;
        border-right: 1px solid var(--SmartThemeBorderColor) !important;
        border-bottom: none !important;
    }

    .vecthare-chunk-detail-panel {
        flex: 1 !important;
    }
}

/* ============================================================================
 * DESKTOP RESTORE (> 768px)
 * ============================================================================ */

@media (min-width: 769px) {
    /* Database Browser - restore desktop sizing */
    .vecthare-database-browser-content {
        max-width: 1200px !important;
        width: 95% !important;
        max-height: 90vh !important;
        height: auto !important;
        min-height: auto !important;
        min-width: auto !important;
        border-radius: 16px !important;
        border: 1px solid
            color-mix(
                in srgb,
                var(--vecthare-primary) 20%,
                var(--SmartThemeBorderColor)
            ) !important;
    }

    /* Content Vectorizer - restore desktop sizing */
    .vecthare-content-vectorizer {
        max-width: 900px !important;
        width: 95% !important;
        max-height: 90vh !important;
        height: auto !important;
        min-height: auto !important;
        min-width: auto !important;
        border-radius: 16px !important;
    }

    /* Visualizer - restore desktop sizing */
    .vecthare-visualizer-container {
        max-width: 1400px !important;
        width: 95% !important;
        max-height: 90vh !important;
        height: auto !important;
        min-height: auto !important;
        min-width: auto !important;
        border-radius: 16px !important;
    }

    /* Side-by-side in visualizer on desktop */
    .vecthare-visualizer-body {
        flex-direction: row !important;
    }

    .vecthare-chunk-list-panel {
        width: 350px !important;
        max-width: 350px !important;
        min-width: 280px !important;
        max-height: none !important;
        border-right: 1px solid var(--SmartThemeBorderColor) !important;
        border-bottom: none !important;
    }
}
